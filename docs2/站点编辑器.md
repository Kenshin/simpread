此功能最低要求 1.1.0 版本，如低于此版本，[请升级](https://simpread.pro) 到最新版本。
***

含义
---

站点编辑器，下称 `SiteEditor`，为 `简悦` 特有的功能；具有 `可编程` `定制化` `在线同步更新` 等特点。

注意事项
---
- 某个网址如已适配 `阅读模式` 后，也同样适合 `聚焦模式`，后者只拥有 `高亮区域` 与 `排除列表`； 

如何同步适配列表
---
选项页 → 站点管理 → 手动同步适配列表
![](https://s1.ax1x.com/2022/11/07/xvlx6U.png)

如何新增/修改
---

- 阅读模式；  
  进入临时阅读模式，点击侧栏，设定 → 站点编辑器。
- 聚焦模式；  
  进入聚焦模式，点击侧栏，设定 → 站点编辑器。

如何删除
---

> 只有本地适配列表才能被删除，**官方（主）适配源** 与  **官方（次）适配源以及第三方适配源** 只能通过 [站点管理器](站点管理器) 删除。

可定制的内容
---

- 标识  
  必填  
- 标题  
  必填  
- 域名  
  必填  
- 描述  
  可为空
- 高亮区域  
  进入 `阅读模式` 后的正文；
- 隐藏列表  
- 自定义 CSS  
  可为空，可以为每个不同的适配源定制不同的样式；
- 头像的名称和地址  
  论坛页时必填
- 前一页和后一页  
  多个页面时必填

可编程包含
---

> 除了 `Html标签` 外，可编程的执行语句为 `[[ 包含的内容 ]]` ，目前支持的关键字包括： `{}` `''` `//` `[]`  ` `` ` 五种。

#### Html  

支持的格式： `<HTML元素 [id|class="xxx"]>`，例如：

```html
<title>
<section class='c-single-normal__title'>
<div id='origin-content'>
```
虽然以下格式也支持，但最好符合上述标准：

```html
<div id='origin-content clear'>
<section class='c-single-normal__title' style='font-size: 14px;'>
```

#### [[{jquery 执行语句}]]

```js
// 执行 $('meta[name=description]').attr('content')，返回字符串
[[{$('meta[name=description]').attr('content')}]]
// 也可以执行复杂的javascript语句
[[{($('.QuestionRichText span').html(JSON.parse(JSON.stringify($.parseJSON($('#js-initialData').text()).initialState.entities.questions).replace(/"\d+":/,'"questions":')).questions.detail.replaceAll('。','.')).text()+'。').replace(/.。$/,'。')}]]
```

####  [['html 标签']]

```html
// 隐藏掉正文中包含此 Html代码段 的内容
[['<span>原创翻译，未经许可，禁止转载</span>']]
```

#### [[/正则表达式/]]

```js
// 执行正则表达式，多用于：隐藏掉正文中包含此 src 的内容，一般针对与 <img> 图片
// 注意语句中使用 \ 需要转移为 \\
[[/src=\\S+(pixel)\\S+'/]]
```

#### [[[jQuery查询语句]]]

```js
// 执行 $('.article-btn') 返回 jQuery 对象
[[[$('.article-btn')]]]
```

#### [[\`/XPath\`]]

```js
[[`/html[1]/div[1]/sr-read[1]/sr-rd-content[1]/p[5]`]]
[[`/html[1]/div[1]/sr-read[1]/sr-rd-content[1]/p[5]/a[1]`]]
```

对应字段
---

> [website_list.json](%E9%80%82%E9%85%8D%E7%AB%99%E7%82%B9%E5%88%97%E8%A1%A8) 对应的字段  

- `name`（标识）  
  必填，用于标识当前 url 的别名，相当于 `id`，例如：  
  ```
   minapp.ifanr.com
   news.ifanr.com
   issues.github.com
   mp.weixin.qq.com
  ```

- `url`（域名）  
  用于标识当前 url，支持三种形式：
  
   精准匹配：
   ```
   https://xxx.com/post/39411
   https://xxx.com/post/1243
   https://xxx.com/post/39411
   ```
  
   模糊匹配：
   > 支持 [minimatch](https://github.com/isaacs/minimatch) 由 [ksky521](https://github.com/ksky521) 提供
   ```
   http://*.cnbeta.com/articles/*/*.htm
   https://www.ithome.com/html/**/*/*.htm
   https://github.com/*/*/issues/*
   ```
  
   正则表达式匹配：
   > 支持 正则表达式，使用前后缀 `[[/` `/]]`
   ```
   [[/https:\\/\\/movie.douban.com\\/subject\\/\\d+\\/?/]]
   ```


- `title`（标题）  
  必填，支持：`Html 标签` `[[{}]]`

- `desc`（描述）  
  选填，支持：`Html 标签` `[[{}]]`

- `include`（高亮）  
  必填，支持：`Html 标签` `[[{}]]` `[[[]]]` `[[``]]`  
  需要注意，在适配论坛页页面时，需要使用 `[[{}]]` 而非 `[[[]]]`

- `exclude`（隐藏列表）  
  选填，Array 类型，支持： `Html 标签` `[['']]` `[[//]]` `[[[]]]` `[[``]]`  

  默认用途为从高亮内容中隐藏匹配到的元素，但也可以从原始内容上删除元素。 

  `[[[]]]` / `[[``]]` **如果匹配到原始页面的元素，则会被从原始页面删除**。要限定只从高亮内容中移除，需要使用高亮内容中的元素来限定匹配范围，如使用 `<sr-read>`

  阅读模式下，几个主要的元素如下：

  ```html
  <sr-read>
    <sr-rd-title>文章标题</sr-rd-title>
    <sr-rd-desc>描述</sr-rd-desc>
    <sr-rd-content class="highlighter-context">
      <!---- 高亮内容 ---->
    </sr-rd-content>
  </sr-read>
  ```
  
  使用示例：
  
  ```js
  // 从高亮内容中移除元素 `<i class="pstatus"></i>`
  [[[$('sr-rd-content .pstatus)]]]
  ```

- `css`（自定义 CSS）  
  选填，支持 CSS 语句

- `name`（头像的名称） `元素列表`  
  论坛页页面必填，单页面是为空。头像的名称 ，仅支持 `[[{}]]`  
  需注意获取头像名称、头像图片地址、高亮内容的结果数量要一致，否则会显示错位。

  ```js
  [[{$('.AuthorInfo-name')}]]
  ```

- `url`（头像的地址） `元素列表`  
  论坛页页面必填，单页面是为空。头像的地址，仅支持 `[[{}]]`  
  需注意获取头像名称、头像图片地址、高亮内容的结果数量要一致，否则会显示错位。

  ```js
  //<img class="Avatar AuthorInfo-avatar" width="38" height="38" src="https://pic2.zhimg.com/v2-01cdd02b9fd7a57469705ad79ad6abb5_xs.jpg?source=1940ef5c" srcset="https://pic2.zhimg.com/v2-01cdd02b9fd7a57469705ad79ad6abb5_l.jpg?source=1940ef5c 2x" alt="盐选成长计划">
  [[{$('.AuthorInfo-avatar')}]]
  ```

- `prev`（前一页） `文本`  
  （选填）前一页的地址 ，仅支持 `[[{}]]` 

  ```js
  // <a href="http://bbs.xxxx.com/viewthread-100000-1-1.html" class="prev">&nbsp;&nbsp;</a>
  [[{$('div.pg a.prev').attr('href')}]]
  // <a class="prev" onclick="javascript:location.href='/xxx/2020_09_05_12345_1.shtml';">上一页</a>
  [[{$('a.prev').attr('onclick')}]]
  ```

- `next`（后一页）  `文本`  
  （选填）后一页的地址 `文本`，仅支持 `[[{}]]` 

  ```js
  // <a href="http://bbs.xxxx.com/viewthread-100000-2-1.html" class="nxt">下一页</a>
  [[{$('div.pg a.next').attr('href')}]]
  // <a class="next" onclick="javascript:location.href='/xxx/2020_09_05_12345_3.shtml';">下一页</a>
  [[{$('a.next').attr('onclick')}]]
  ```